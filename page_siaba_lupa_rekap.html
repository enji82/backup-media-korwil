<header>
  <h2>REKAP JUMLAH LUPA PRESENSI</h2>
</header>

<div class="filter-container">
  <div class="filter-group">
    <label for="filterTahunRekap">Tahun:</label>
    <select id="filterTahunRekap"></select>
  </div>
  <div class="filter-group">
    <label for="filterUnitKerjaRekap">Unit Kerja:</label>
    <select id="filterUnitKerjaRekap"></select>
  </div>
</div>

<main class="table-view-container">
  <div id="tableWrapperRekap" style="display:flex; position: relative;"> 
    
    <div id="tableOverlayLoaderRekap" style="display: flex; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); z-index: 100; justify-content: center; align-items: center; flex-direction: column; border-radius: 8px; backdrop-filter: blur(2px);">
        <div class="spinner-container">
            <div class="spinner-bar" style="background-color: #e74c3c;"></div>
            <div class="spinner-bar" style="background-color: #2ecc71;"></div>
            <div class="spinner-bar" style="background-color: #f1c40f;"></div>
            <div class="spinner-bar" style="background-color: #3498db;"></div>
        </div>
        <p style="margin-top: 15px; color: white; font-weight: bold; letter-spacing: 1px;">Memuat Data Rekap...</p>
    </div>

    <div class="table-container">
        <table id="lupaRekapTable" class="data-table freeze-pane-table">
          <thead>
            <tr>
              <th>No.</th>
              <th>Nama ASN</th>
              <th>NIP</th>
              <th>Jan</th><th>Feb</th><th>Mar</th><th>Apr</th><th>Mei</th><th>Jun</th>
              <th>Jul</th><th>Agt</th><th>Sep</th><th>Okt</th><th>Nov</th><th>Des</th>
              <th>Jumlah</th>
            </tr>
          </thead>
          <tbody></tbody>
          <tfoot></tfoot>
        </table>
    </div>
  </div> 
</main>

<style>
  /* Layout */
  #main-content { overflow-y: hidden !important; }
  main.table-view-container { flex-grow: 1 !important; min-height: 0 !important; display: flex !important; flex-direction: column !important; }
  #tableWrapperRekap { flex-grow: 1 !important; min-height: 0 !important; display: flex !important; flex-direction: column !important; margin-bottom: 0; }
  #tableWrapperRekap .table-container { flex-grow: 1 !important; overflow: auto !important; border-radius: 10px; border-bottom: none; }
  #tableWrapperRekap .table-container::-webkit-scrollbar { display: none !important; }
  
  /* Freeze Pane (Header) */
  #lupaRekapTable thead th { 
      position: sticky; 
      top: 0; 
      z-index: 5; 
      background-color: #101E26; 
      border-bottom: 2px solid rgba(0, 195, 255, 0.5); 
  }
  
  /* Freeze Pane (Kolom Nama & No) - BODY */
  #lupaRekapTable tbody td:nth-child(1), 
  #lupaRekapTable tbody td:nth-child(2) { 
      position: sticky; 
      background-color: #1c2e3a; 
      z-index: 3; 
  }
  
  /* === [PERBAIKAN BUG HEADER] === */
  /* Sudut Kiri Atas (Header Kolom 1: No.) */
  #lupaRekapTable thead th:nth-child(1) { 
      left: 0; 
      z-index: 7; 
  }
  /* Sudut Kiri Atas (Header Kolom 2: Nama ASN) */
  #lupaRekapTable thead th:nth-child(2) { 
      left: 50px; /* Geser 50px agar tidak menumpuk di kolom No */
      z-index: 7; 
  }
  /* === [AKHIR PERBAIKAN] === */

  /* Posisi Kiri Kolom Body */
  #lupaRekapTable tbody td:nth-child(1) { left: 0; }
  #lupaRekapTable tbody td:nth-child(2) { left: 50px; text-align: left !important; }
  
  /* Footer Sticky */
  #lupaRekapTable tfoot td { 
      position: sticky; 
      bottom: 0; 
      z-index: 5; 
      background-color: #101E26; 
      font-weight: bold; 
      border-top: 2px solid rgba(0, 195, 255, 0.5); 
      color: #e0e0e0; 
  }
  
  /* Sudut Kiri Bawah (Footer) */
  #lupaRekapTable tfoot td:nth-child(1), 
  #lupaRekapTable tfoot td:nth-child(2) { 
      position: sticky; 
      z-index: 7; 
      background-color: #101E26; 
  }
  #lupaRekapTable tfoot td:nth-child(1) { left: 0; }
  #lupaRekapTable tfoot td:nth-child(2) { left: 50px; text-align: left !important; }

  /* Kolom Jumlah (Terakhir) */
  #lupaRekapTable th:last-child, 
  #lupaRekapTable tbody td:last-child,
  #lupaRekapTable tfoot td:last-child { 
      font-weight: bold; 
      color: var(--color-orange) !important; 
  }
</style>